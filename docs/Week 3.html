<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Personal Diary for CASA0023 - 4&nbsp; Geometric and Atmospheric Correction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Week 4.html" rel="next">
<link href="./Week 2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Week 3.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Geometric and Atmospheric Correction</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Personal Diary for CASA0023</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">About me</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week 1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to Remote Sensing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week 2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Landsat Satellites and Their Importance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week 3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Geometric and Atmospheric Correction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week 4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Public Policy Case Study</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week 6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Google Earth Engine</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week 7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Classification I</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week 8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Classification II</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week 9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Temperature and Urban Heat Islands</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary"><span class="header-section-number">4.1</span> Summary</a>
  <ul class="collapse">
  <li><a href="#what-is-it-and-why-is-it-important" id="toc-what-is-it-and-why-is-it-important" class="nav-link" data-scroll-target="#what-is-it-and-why-is-it-important"><span class="header-section-number">4.1.1</span> <strong>What is it, and why is it important?</strong></a></li>
  <li><a href="#types-of-correction" id="toc-types-of-correction" class="nav-link" data-scroll-target="#types-of-correction"><span class="header-section-number">4.1.2</span> <strong>Types of Correction</strong></a></li>
  <li><a href="#methods-for-enhancement" id="toc-methods-for-enhancement" class="nav-link" data-scroll-target="#methods-for-enhancement"><span class="header-section-number">4.1.3</span> <strong>Methods for Enhancement</strong></a></li>
  </ul></li>
  <li><a href="#in-class-application-of-glcm-method" id="toc-in-class-application-of-glcm-method" class="nav-link" data-scroll-target="#in-class-application-of-glcm-method"><span class="header-section-number">4.2</span> <strong>In class-application of GLCM Method</strong></a></li>
  <li><a href="#real-world-application" id="toc-real-world-application" class="nav-link" data-scroll-target="#real-world-application"><span class="header-section-number">4.3</span> Real world application</a></li>
  <li><a href="#personal-reflection" id="toc-personal-reflection" class="nav-link" data-scroll-target="#personal-reflection"><span class="header-section-number">4.4</span> Personal Reflection:</a></li>
  <li><a href="#bibliography" id="toc-bibliography" class="nav-link" data-scroll-target="#bibliography"><span class="header-section-number">4.5</span> Bibliography</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Geometric and Atmospheric Correction</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="summary" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="summary"><span class="header-section-number">4.1</span> Summary</h2>
<p>The subject this week was correction and different ways in which we could edit, improve and enhance images to better suit the specific analysis that we want. It was a very technical and scientific week. For this week diary entry, I will start with a quick summary of the technical definitions and processes that I learnt, and then I have decided to go into detail on the practical that we did in class in which we applied Grey Level Co-Occurence Matrix to correct the texture of an image, as well as analyse a real world case in Colombia where this methodology was also used.I finish this entry with my personal reflections.</p>
<section id="what-is-it-and-why-is-it-important" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="what-is-it-and-why-is-it-important"><span class="header-section-number">4.1.1</span> <strong>What is it, and why is it important?</strong></h3>
<p>Just like any data recollection tool, Satellites are not always accurate and need some sort of correction or enhancements to improve the images they gather. The distortions can be caused by many things such as wrong view angles, harsh variations in topography, strong winds, or other climactic conditions such as rain or snow.</p>
<p>Geometric correction is the process in which satellite imagery is corrected. Each image has reference markers, such as each coordinates, which help trace and map images from before and after. All of these images are then passed through different mathematical algorithms for correction.</p>
<p>There are many different types of correction and enhancement.I will get into further detail about Dark Object Subtraction.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.mdpi.com/2072-4292/15/16/3965"><img src="correction.png" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">Geometric Correction</figcaption>
</figure>
</div>
</section>
<section id="types-of-correction" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="types-of-correction"><span class="header-section-number">4.1.2</span> <strong>Types of Correction</strong></h3>
<p>Radiometric: Correcting the digital number to reflectance. Different uses of sensors result in different known values.</p>
<p>Geometric: Deals with data distortion.Requires input to ortho-refortify using control points and DEM (Digital Elevation Model).</p>
<p>Atmospheric: Corrects for atmospheric effects on sensor data. Involves local and empirical methods.</p>
<p>Orthorectification: Involves forcing a view to be correct as if viewed from above.</p>
</section>
<section id="methods-for-enhancement" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="methods-for-enhancement"><span class="header-section-number">4.1.3</span> <strong>Methods for Enhancement</strong></h3>
<p>All though there are many types of enhancement that can be done to satellite imaging, I will talk about just a few:</p>
<p><strong>Ratio:</strong> Rationing involves calculating the difference between two spectral bands to highlight specific landscape features. The Normalized Difference Vegetation Index (NDVI) is a common example, exploiting the spectral trait where healthy vegetation reflects more in the Near-Infrared (NIR) but absorbs in the Red wavelength. This method is useful for identifying areas with healthy vegetation.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.researchgate.net/publication/342413913_Testing_the_Multiple_Pathways_of_Residential_Greenness_to_Pregnancy_Outcomes_Model_in_a_Sample_of_Pregnant_Women_in_the_Metropolitan_Area_of_Donostia-San_Sebastian"><img src="Screenshot 2024-03-11 114906.png" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">Ratio Correction</figcaption>
</figure>
</div>
<p><strong>Filtering:</strong> Filtering applies moving window operations to data, which can enhance or suppress certain features. An example is the Laplacian filter, used to highlight edges or contrast in the imagery, thus aiding in feature identification and analysis.</p>
<p><strong>Texture</strong> Texture Analysis focuses on the pixel-to-pixel relationships within an image to describe surface characteristics. This technique is valuable for distinguishing between different land cover types based on their texture, such as smooth grassland or bumpy deciduous forests.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.researchgate.net/publication/346042476_STAIR_20_A_Generic_and_Automatic_Algorithm_to_Fuse_Modis_Landsat_and_Sentinel-2_to_Generate_10_m_Daily_and_Cloud-Gap-Free_Surface_Reflectance_Product"><img src="texture correction.png" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">Texture Correction</figcaption>
</figure>
</div>
<p><strong>Joining Data</strong> Preprocessing steps performed on collected data. Methods include enhancement, feature extraction, etc.</p>
<p><strong>Feathering</strong> When you join two matching images together. Creates a seamless image without harsh boundaries.</p>
<p><strong>Mosaicking</strong> Images are pieced together to form one large image.</p>
</section>
</section>
<section id="in-class-application-of-glcm-method" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="in-class-application-of-glcm-method"><span class="header-section-number">4.2</span> <strong>In class-application of GLCM Method</strong></h2>
<p>One of the practical exercises this week, was to use the GLCM package in R Studio to correct the texture in some satellite imagery.</p>
<p>The GLCM method is used to extract statistical measures from satellite images that can help differentiate between different land cover types based on their texture, such as distinguishing forests from urban areas.</p>
<p>The GLCM package facilitates texture analysis by computing a matrix where the frequency of co-occurring pixel values at a certain spatial relationship is recorded. This matrix is then used to calculate various texture statistics that describe the heterogeneity or patterns within the image.</p>
<ul>
<li>The size of the moving window determines how large an area each calculation considers. A window of size (7, 7) means that for each pixel, the texture is analyzed based on its 7x7 neighbors.</li>
<li>The shift parameter defines the spatial relationship between pixel pairs considered in the GLCM. It’s essentially the direction and distance between the pair of pixels.</li>
<li>The GLCM package can compute various texture measures such as homogeneity, contrast, and correlation. These measures provide quantitative data on the texture’s smoothness, variation, and spatial dependency among pixels. The choice of statistics will depend on the aspect of texture you are interested in analyzing.</li>
</ul>
<p>Interpretation of results: - Color Scale: A value closer to 1 indicates high homogeneity, meaning the texture is very uniform in that area. Values closer to 0 suggest low homogeneity, where the texture is less uniform and more varied. - Color Representation: The colors in the image correspond to the homogeneity values at each location. For example, areas colored in green might indicate regions of higher homogeneity, while yellow to pink areas might represent lower homogeneity. - Spatial Distribution: The distribution of colors across the plot shows how homogeneity varies spatially. Clusters of similar colors indicate areas with similar texture properties. For example, large green areas would be more uniform in texture, possibly open fields or water bodies, while mixed colors like yellow and pink could suggest urban or forested areas with more complex structures.</p>
</section>
<section id="real-world-application" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="real-world-application"><span class="header-section-number">4.3</span> Real world application</h2>
<p>While searching for a real life application of this methodology, I found this investigation done in Colombia, specifically in the lower Magdalena river region. It was a very innovative study in which they integrated both Sentinel-1 and Sentinel-2 data to improve the spectral quality in their land cover images. They implemented various correction methodologies as well as more advanced machine learning processes, their objective was to tackle the cloud coverage which always affects imaging in this region of the world. They were very successful in classifying land cover which is a great advance for natural resource management and climate change adaptation, one of Colombia’s environmental pillars.</p>
<p>The scientific journal mentions that within their methodologies, GLCM was used in a to enhance land cover mapping in Colombia.</p>
</section>
<section id="personal-reflection" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="personal-reflection"><span class="header-section-number">4.4</span> Personal Reflection:</h2>
<p>If one is going to learn about remote sensing data, one must also learn about how to correct and enhance the images and data. These techniques make sure that the pictures and data we get from satellites will really show what’s happening on Earth.</p>
<p>As an anthropologist, working in environmental conservation and rural development, and now diving into data science, I am getting very inspired by all of this new information regarding remote sensing. Remote sensing will let me gather lots of info about our planet and using these correction techniques, it will be easier to make smart decisions for the environment and how rural areas develop.</p>
<p>I really enjoyed applying the GLCM method because it provided key insights into the spatial arrangement of pixel values. This could easily be used for land cover classification, environmental monitoring, and urban planning, where understanding the texture is crucial for accurate analysis.This is something that I in-vision myself using in my personal and professional interests.</p>
<p>It was fascinating for me to read the scientific journal of scientists applying what I had applied in a practical, in a real life case of improving image quality to be able to identify and characterise land cover and vegetation.</p>
</section>
<section id="bibliography" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="bibliography"><span class="header-section-number">4.5</span> Bibliography</h2>
<ol type="1">
<li>Anabitarte, Asier, et al.&nbsp;“Testing the Multiple Pathways of Residential Greenness to Pregnancy Outcomes Model in a Sample of Pregnant Women in the Metropolitan Area of Donostia-San Sebastián.” International Journal of Environmental Research and Public Health, vol.&nbsp;17, no. 12, 23 June 2020, p.&nbsp;4520, pubmed.ncbi.nlm.nih.gov/32586011/, https://doi.org/10.3390/ijerph17124520.</li>
<li>Clerici, Nicola, et al.&nbsp;“Fusion of Sentinel-1A and Sentinel-2A Data for Land Cover Mapping: A Case Study in the Lower Magdalena Region, Colombia.” Journal of Maps, vol.&nbsp;13, no. 2, 12 Sept.&nbsp;2017, pp.&nbsp;718–726, https://doi.org/10.1080/17445647.2017.1372316.</li>
<li>Joyce, K., 2013. Radiative transfer and atmospheric correction video</li>
<li>Jensen, J.R., 2015. Introductory digital image processing: a remote sensing perspective. Prentice-Hall Inc.</li>
<li>Oh, Myeongchan, et al.&nbsp;“Real-Time Terrain Correction of Satellite Imagery-Based Solar Irradiance Maps Using Precomputed Data and Memory Optimization.” Remote Sensing, vol.&nbsp;15, no. 16, 1 Jan.&nbsp;2023, p.&nbsp;3965, www.mdpi.com/2072-4292/15/16/3965, https://doi.org/10.3390/rs15163965. Accessed 20 Mar.&nbsp;2024.</li>
<li>Young, Peter, et al.&nbsp;“From Image Descriptions to Visual Denotations: New Similarity Metrics for Semantic Inference over Event Descriptions.” Transactions of the Association for Computational Linguistics, vol.&nbsp;2, Dec.&nbsp;2014, pp.&nbsp;67–78, https://doi.org/10.1162/tacl_a_00166. Accessed 10 Apr.&nbsp;2020.</li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Week 2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Landsat Satellites and Their Importance</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Week 4.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Public Policy Case Study</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>